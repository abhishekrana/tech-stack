version: '3'

vars:
  K3D_VERSION: 5.5.2
  K9S_VERSION: 0.27.4
  KUBECTL_VERSION: 1.28.0
  TILT_VERSION: 0.33.4

tasks:
  k3d:
    cmds:
      - curl -s https://raw.githubusercontent.com/k3d-io/k3d/main/install.sh | TAG=v{{.K3D_VERSION}} bash

  k9s:
    dir: /tmp
    cmds:
      - |
        rm -f k9s_Linux_amd64.tar.gz
        wget https://github.com/derailed/k9s/releases/download/v{{.K9S_VERSION}}/k9s_Linux_amd64.tar.gz
        tar -xzvf k9s_Linux_amd64.tar.gz
        sudo mv k9s /usr/local/bin/

  kubectl:
    dir: /tmp
    cmds:
      - curl -LO "https://dl.k8s.io/release/v{{.KUBECTL_VERSION}}/bin/linux/amd64/kubectl"
      - sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
      - echo 'source <(kubectl completion bash)' >>~/.bashrc

  tilt:
    dir: /tmp
    cmds:
      - curl -fsSL https://github.com/tilt-dev/tilt/releases/download/v{{.TILT_VERSION}}/tilt.{{.TILT_VERSION}}.linux.x86_64.tar.gz | tar -xzv tilt
      - sudo mv tilt /usr/local/bin/tilt
